set printJson true
#
test select 10 as timestamp
0: {"$type":"","symbol":"","$1":"1970-01-01T00:00:00.010Z"}
!end
test select 10d5h20m as timestamp
0: {"$type":"","symbol":"","$1":"1970-01-11T05:20:00.000Z"}
!end
test select 10d5h20m as timestamp as int64
0: {"$type":"","symbol":"","$1":883200000}
!end
# test select 11 as timeofday
# 0: {"$type":"","symbol":"","$1":"00:00:00.011"}
# !end
# test select 5h10m as timeofday
# 0: {"$type":"","symbol":"","$1":"05:10"}
# !end
# test select 5h10m as timeofday + 10
# 0: {"$type":"","symbol":"","$1":"05:10:00.010"}
# !end
# test select 5h10m as timeofday + 5h10m as timeofday
# 0: {"$type":"","symbol":"","$1":"10:20"}
# !end
test select '2022-08-27 23:32:00.007'd as int64
0: {"$type":"","symbol":"","$1":1661643120007}
!end
test select '2022-08-27 23:32:00.007'd - '2022-08-27 00:00:00.007'd
0: {"$type":"","symbol":"","$1":84720000}
!end
test select '2022-08-27 23:32:00.007'd - 1d10m
0: {"$type":"","symbol":"","$1":"2022-08-26T23:22:00.007Z"}
!end
test select 1d10m + '2022-08-27 23:32:00.007'd
0: {"$type":"","symbol":"","$1":"2022-08-28T23:42:00.007Z"}
!end
test select '2022-08-27 23:32:00.007'd + 3
0: {"$type":"","symbol":"","$1":"2022-08-27T23:32:00.010Z"}
!end
test select ['2022-08-27 23:32:00.007'd, '2022-08-27 23:33:00.007'd] as array(int64)
0: {"$type":"","symbol":"","$1":[1661643120007,1661643180007]}
!end
test select [10, 10] as array(timestamp)
0: {"$type":"","symbol":"","$1":["1970-01-01T00:00:00.010Z","1970-01-01T00:00:00.010Z"]}
!end
# test select [10, 10] as array(timeofday)
# 0: {"$type":"","symbol":"","$1":["00:00:00.010","00:00:00.010"]}
# !end
test select ['2022-08-27 23:32:00.007'd, '2022-08-27 23:33:00.007'd] - 1
0: {"$type":"","symbol":"","$1":["2022-08-27T23:32:00.006Z","2022-08-27T23:33:00.006Z"]}
!end
test select 1d + ['2022-08-27 23:32:00.007'd, '2022-08-27 23:33:00.007'd]
0: {"$type":"","symbol":"","$1":["2022-08-28T23:32:00.007Z","2022-08-28T23:33:00.007Z"]}
!end
test select ['2022-08-27 23:32:00.007'd, '2022-08-27 23:33:00.007'd] - ['2022-08-27 23:32:00.007'd, '2022-08-27 23:33:00.007'd]
0: {"$type":"","symbol":"","$1":[0,0]}
!end
test select ['2022-08-27 23:32:00.007'd, '2022-08-27 23:33:00.007'd] - '2022-08-27 23:33:00.001'd
0: {"$type":"","symbol":"","$1":[-59994,6]}
!end
test select (['2022-08-27 23:32:00.007'd, '2022-08-27 23:33:00.007'd] - '2022-08-27 23:32:00.001'd) as array(int64)
0: {"$type":"","symbol":"","$1":[6,60006]}
!end
test select ['2022-08-27 23:32:00.007'd, '2022-08-27 23:33:00.007'd] + [5, 10]
0: {"$type":"","symbol":"","$1":["2022-08-27T23:32:00.012Z","2022-08-27T23:33:00.017Z"]}
!end
test select timestamp as int64 from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":1618794796646}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","$1":1618794856646}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":1618794916646}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":1618794976646}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","$1":1618795036646}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","$1":1618795096646}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","$1":1618795156646}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","$1":1618795216646}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","$1":1618795276646}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":1618795336646}
!end
test select timestampField as int64 from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":1617719194460}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","$1":1617742163983}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":1618326175093}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":1618311133567}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","$1":1618663972150}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","$1":1617982128961}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","$1":1617378908869}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","$1":1617448318180}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","$1":1618583595804}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":1617580507774}
!end
test select timestamp - timestampField from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":1075602186}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","$1":1052692663}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":468741553}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":483843079}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","$1":131064496}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","$1":812967685}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","$1":1416247777}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","$1":1346898466}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","$1":211680842}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":1214828872}
!end
test select timestamp - timestampField as int64 from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":1075602186}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","$1":1052692663}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":468741553}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":483843079}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","$1":131064496}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","$1":812967685}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","$1":1416247777}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","$1":1346898466}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","$1":211680842}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":1214828872}
!end
test select timestampList + 10 from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":["2021-04-16T02:05:17.829Z","2021-04-15T21:29:23.737Z","2021-04-10T16:06:17.183Z","2021-04-04T17:24:27.967Z","2021-03-30T15:57:51.368Z","2021-04-04T22:55:41.560Z","2021-04-12T11:25:20.011Z","2021-04-18T13:01:06.710Z","2021-04-13T20:37:18.807Z","2021-03-31T05:53:49.283Z"]}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","$1":["2021-04-07T12:50:01.524Z","2021-04-02T20:36:43.597Z","2021-04-02T09:18:13.663Z","2021-04-03T09:22:45.459Z","2021-04-10T22:39:44.767Z","2021-04-18T22:42:09.049Z","2021-04-13T09:37:44.724Z","2021-03-31T20:50:55.523Z","2021-03-30T23:20:49.674Z","2021-03-30T13:47:38.153Z"]}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":["2021-04-08T19:51:58.846Z","2021-04-16T12:02:53.399Z","2021-04-15T01:30:07.385Z","2021-04-01T19:16:12.249Z","2021-03-30T15:44:02.031Z","2021-04-10T06:58:57.209Z","2021-04-13T11:10:50.573Z","2021-03-31T05:14:44.759Z","2021-04-03T07:52:10.765Z","2021-04-10T01:55:50.384Z"]}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":["2021-04-19T02:09:28.289Z","2021-04-14T07:15:41.218Z","2021-04-11T06:10:21.460Z","2021-04-16T09:01:51.893Z","2021-03-31T06:23:35.165Z","2021-04-02T03:32:48.624Z","2021-04-05T03:17:54.963Z","2021-03-31T02:32:53.877Z","2021-04-09T07:25:18.891Z","2021-04-11T16:59:10.244Z"]}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","$1":["2021-04-13T18:37:49.568Z","2021-04-04T08:41:15.449Z","2021-04-01T22:16:19.763Z","2021-04-10T11:12:49.291Z","2021-04-11T19:53:22.817Z","2021-04-13T12:15:32.299Z","2021-04-08T21:46:05.400Z","2021-04-01T16:51:57.557Z","2021-04-14T00:16:42.993Z","2021-04-04T02:04:09.167Z"]}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","$1":["2021-04-14T03:48:06.658Z","2021-04-12T09:08:49.543Z","2021-04-19T00:24:51.484Z","2021-04-14T14:06:16.178Z","2021-04-11T21:47:13.354Z","2021-04-13T18:18:53.486Z","2021-04-06T12:49:28.000Z","2021-04-08T16:18:45.038Z","2021-04-11T09:49:29.104Z","2021-04-17T01:35:24.448Z"]}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","$1":["2021-04-04T12:26:52.834Z","2021-04-19T09:28:07.718Z","2021-04-18T02:10:01.433Z","2021-04-11T15:35:58.904Z","2021-04-09T00:01:16.072Z","2021-04-08T22:47:31.724Z","2021-04-05T07:25:37.035Z","2021-03-31T21:24:13.780Z","2021-04-07T06:47:47.651Z","2021-04-14T04:35:25.485Z"]}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","$1":["2021-04-10T12:20:22.169Z","2021-04-09T16:39:00.998Z","2021-03-31T14:46:17.984Z","2021-04-02T11:29:47.274Z","2021-04-17T06:59:55.591Z","2021-04-09T01:29:16.792Z","2021-04-08T08:52:27.314Z","2021-04-13T18:34:35.864Z","2021-04-16T00:45:32.610Z","2021-04-07T05:56:04.543Z"]}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","$1":["2021-04-11T13:27:18.829Z","2021-04-02T11:21:47.769Z","2021-04-12T05:59:44.509Z","2021-04-06T10:09:48.289Z","2021-04-17T22:55:16.044Z","2021-03-31T23:30:43.233Z","2021-04-11T01:40:14.541Z","2021-04-10T18:09:18.217Z","2021-04-06T13:11:47.660Z","2021-04-05T04:19:54.560Z"]}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":["2021-04-10T06:01:00.711Z","2021-03-31T00:39:11.305Z","2021-04-07T17:46:09.680Z","2021-04-04T18:34:24.154Z","2021-04-16T11:37:33.867Z","2021-04-12T16:54:29.767Z","2021-04-14T20:38:10.520Z","2021-04-16T09:59:59.394Z","2021-03-31T05:25:53.849Z","2021-04-16T03:08:51.265Z"]}
!end
test select timestampList - nullableTimestampList from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":[58815456,853165666,829297918,353915143,-1101318765,-1068517458,849507446,589995130,-76289686,-664829111]}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","$1":[]}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":[-75431155,888888525,211111619,-1502956527,-373558628,-565313110,285205765,-214167119,-380306022,188419027]}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":[57571369,1030918285,568630814,554403542,-660989294,-682916019,-983863117,-686175438,277125733,766031378]}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","$1":[]}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","$1":[]}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","$1":[]}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","$1":[]}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","$1":[]}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":[-130767470,-694367095,-654758988,-414052818,1169723594,-40464882,-143983379,1394870866,33353187,256508912]}
!end
test select timestampList - nullableTimestampList as array(int64) from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":[58815456,853165666,829297918,353915143,-1101318765,-1068517458,849507446,589995130,-76289686,-664829111]}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z"}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":[-75431155,888888525,211111619,-1502956527,-373558628,-565313110,285205765,-214167119,-380306022,188419027]}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":[57571369,1030918285,568630814,554403542,-660989294,-682916019,-983863117,-686175438,277125733,766031378]}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z"}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z"}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z"}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z"}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z"}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":[-130767470,-694367095,-654758988,-414052818,1169723594,-40464882,-143983379,1394870866,33353187,256508912]}
!end
test select (timestampList as array(int64)) * (nullableTimestampList as array(int64)) from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":[5600311158031972985,-5493166187321083613,-7043593739566096413,4059807952248667654,2528504058427951274,8057445843909262208,3632267105534879627,-1451664644020649768,7054449142965957191,-6113426566325774064]}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z"}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":[718960717226255532,-4383310166371442560,7570011495963064052,-4675045280924228574,3562161847221929293,3421152731138214507,-5439436072031066694,-4624214927392423124,7864479138153343803,-2170886444900894702]}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":[-1022705899848289758,-649333680839641336,6750979764000299576,3789313256808895815,-6545730205925624301,1402407941077911286,-4174781000249553018,7854548428330515155,7635554446054391228,-2244967330643514160]}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z"}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z"}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z"}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z"}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z"}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":[8482186809388990911,-969292381110882230,6775273076167572972,5490113151750987296,-2684382298870161865,-4903390737745952717,9062187702548311694,1336351664428680592,3086354095608654324,-6882872468237676991]}
!end
test select longField as timestamp from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":"141187031-05-07T15:17:56.261Z"}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","$1":"151506793-02-26T23:23:22.068Z"}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":"233190161-07-19T00:12:55.823Z"}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":"123303373-01-29T18:42:32.263Z"}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","$1":"222462846-01-25T06:56:10.791Z"}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","$1":"179715513-01-03T10:36:51.475Z"}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","$1":"125623889-03-04T05:11:18.819Z"}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","$1":"242791699-07-14T22:01:21.897Z"}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","$1":"108491233-04-17T09:44:56.918Z"}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":"279729157-05-20T06:18:49.483Z"}
!end
# test select boolField as timeofday from "1min-1h-1h-3"
# 0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":"00:00"}
# 1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","$1":"00:00"}
# 2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":"00:00"}
# 3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":"00:00:00.001"}
# 4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","$1":"00:00:00.001"}
# 5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","$1":"00:00"}
# 6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","$1":"00:00"}
# 7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","$1":"00:00:00.001"}
# 8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","$1":"00:00:00.001"}
# 9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":"00:00:00.001"}
# !end
test select intList as array(timestamp) from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":["1970-01-15T14:42:08.488Z","1969-12-07T10:25:02.872Z","1969-12-07T22:48:09.597Z","1969-12-26T11:04:46.474Z","1969-12-18T18:27:23.356Z","1970-01-20T23:07:39.815Z","1969-12-17T08:14:35.813Z","1970-01-11T05:25:12.748Z","1969-12-18T03:21:29.133Z","1970-01-10T12:24:43.684Z"]}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","$1":["1970-01-23T17:29:57.559Z","1969-12-14T04:26:13.612Z","1969-12-19T19:48:38.295Z","1970-01-11T14:29:46.000Z","1970-01-15T02:57:16.720Z","1970-01-18T09:03:57.343Z","1970-01-16T17:04:48.810Z","1969-12-20T16:04:03.259Z","1970-01-21T10:02:00.606Z","1969-12-08T14:23:06.275Z"]}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":["1970-01-03T11:31:38.034Z","1969-12-15T13:04:11.118Z","1970-01-03T01:41:02.045Z","1970-01-10T20:06:50.608Z","1970-01-01T00:53:10.508Z","1970-01-21T17:14:57.050Z","1970-01-08T18:34:19.452Z","1969-12-12T14:44:19.005Z","1969-12-23T02:08:27.561Z","1969-12-17T02:48:51.808Z"]}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":["1970-01-03T00:52:41.687Z","1970-01-14T08:32:24.710Z","1970-01-20T14:39:58.431Z","1969-12-20T15:30:31.501Z","1969-12-07T04:49:34.885Z","1970-01-04T17:43:23.644Z","1969-12-31T17:19:27.329Z","1969-12-26T18:25:11.083Z","1970-01-18T20:44:56.917Z","1970-01-18T02:54:06.975Z"]}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","$1":["1969-12-28T04:06:19.467Z","1969-12-08T00:00:37.018Z","1969-12-20T13:31:57.775Z","1970-01-20T19:22:40.841Z","1970-01-19T06:16:42.806Z","1970-01-11T08:33:50.076Z","1969-12-10T23:54:42.378Z","1969-12-27T16:54:06.529Z","1969-12-30T14:55:03.538Z","1970-01-14T16:45:28.996Z"]}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","$1":["1969-12-13T12:26:55.505Z","1970-01-02T01:40:58.860Z","1970-01-03T04:46:25.422Z","1969-12-30T15:05:15.591Z","1970-01-09T18:23:22.094Z","1969-12-15T01:13:23.340Z","1969-12-30T15:57:10.339Z","1970-01-07T21:02:23.151Z","1970-01-17T16:38:33.431Z","1970-01-10T05:59:21.757Z"]}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","$1":["1969-12-29T16:11:41.527Z","1970-01-23T19:47:17.222Z","1970-01-09T02:21:16.048Z","1970-01-16T08:48:18.853Z","1970-01-22T02:12:47.905Z","1969-12-19T13:56:58.293Z","1970-01-06T10:05:27.857Z","1970-01-22T11:55:49.245Z","1969-12-19T18:29:11.363Z","1969-12-30T00:53:23.375Z"]}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","$1":["1970-01-02T23:11:54.696Z","1970-01-13T11:47:20.647Z","1970-01-20T18:56:15.504Z","1969-12-11T20:26:28.199Z","1970-01-15T14:32:22.986Z","1969-12-31T08:26:27.733Z","1970-01-04T04:48:52.291Z","1969-12-24T18:59:04.151Z","1969-12-16T07:37:31.640Z","1970-01-06T20:06:15.670Z"]}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","$1":["1970-01-07T21:10:15.486Z","1969-12-26T16:00:28.021Z","1970-01-18T01:31:21.601Z","1969-12-10T03:40:34.723Z","1970-01-08T22:03:52.903Z","1970-01-20T10:56:57.332Z","1970-01-13T08:20:34.125Z","1969-12-15T14:33:36.538Z","1970-01-17T01:52:28.589Z","1970-01-09T21:40:01.086Z"]}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":["1969-12-25T10:23:40.223Z","1969-12-18T00:06:01.117Z","1970-01-04T21:51:09.871Z","1969-12-24T22:49:02.410Z","1969-12-09T05:57:48.976Z","1969-12-26T18:20:32.048Z","1969-12-13T11:42:26.943Z","1970-01-17T21:08:42.883Z","1969-12-13T06:04:41.760Z","1969-12-17T07:40:16.271Z"]}
!end
test select longList as array(timestamp) from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":["61349488-11-04T14:09:05.668Z","157950868-07-07T23:58:49.031Z","110515422-11-29T17:15:18.286Z","41547492-02-23T09:19:16.433Z","2332772-06-13T17:15:30.143Z","142153354-12-27T21:54:51.411Z","61079646-09-17T23:11:28.296Z","91063304-01-28T15:34:40.154Z","67766072-11-28T14:40:20.403Z","98456460-07-22T16:35:02.582Z"]}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","$1":["207539896-01-13T13:42:40.818Z","163497931-06-19T11:28:51.273Z","84550360-04-10T00:43:55.852Z","2819045-04-09T21:30:04.432Z","7685598-04-26T15:12:06.395Z","100539607-01-09T07:17:22.794Z","90779251-01-23T16:42:26.955Z","114260879-04-18T18:14:13.164Z","289236605-04-28T06:14:56.920Z","6646940-08-27T16:21:57.351Z"]}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":["52197998-10-28T15:59:31.901Z","171499159-03-19T13:02:40.589Z","91905546-04-03T23:12:02.076Z","218134976-08-12T08:19:07.298Z","156278013-06-04T08:30:04.383Z","243427397-05-21T07:06:48.801Z","261898847-10-22T18:45:40.585Z","173384635-04-18T20:41:20.153Z","144758895-02-18T03:23:45.366Z","120787054-11-09T02:43:02.461Z"]}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":["272706886-01-13T22:54:30.166Z","262692426-04-01T10:18:38.587Z","212602219-06-12T00:44:41.739Z","201310583-11-02T23:24:22.927Z","244073820-06-23T19:09:07.804Z","220771712-11-06T10:45:36.051Z","239767549-05-14T09:56:07.088Z","82096209-07-30T04:18:40.058Z","88214610-08-08T23:14:50.189Z","66540683-10-02T04:45:57.925Z"]}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","$1":["175845637-08-27T21:49:52.890Z","151535728-03-05T12:34:31.135Z","283804363-10-01T12:42:13.178Z","153984910-10-07T07:14:20.388Z","289562174-10-07T18:53:55.622Z","162921614-08-20T11:45:09.536Z","101093126-02-25T01:33:57.010Z","55860676-06-16T04:15:13.331Z","2051438-07-05T06:44:30.222Z","16206073-09-27T16:04:20.080Z"]}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","$1":["239014466-08-05T11:14:56.852Z","77895605-01-21T07:27:44.092Z","137533017-09-29T14:59:58.340Z","195867950-06-18T11:57:13.164Z","5302472-02-25T02:22:28.870Z","212803675-09-10T10:14:00.319Z","84961594-03-09T16:42:12.557Z","288485800-11-13T18:35:00.600Z","187903957-11-21T22:15:12.597Z","20084967-02-12T16:56:47.681Z"]}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","$1":["74831236-09-21T03:46:03.758Z","5076109-07-28T13:53:18.681Z","191912423-05-26T18:53:39.711Z","71044372-06-20T19:08:59.406Z","188471788-12-09T22:01:10.565Z","77439751-08-22T14:37:55.343Z","200406945-07-08T23:00:01.930Z","48127770-09-06T14:48:10.604Z","240716858-05-15T05:17:34.950Z","198190305-05-14T00:55:17.937Z"]}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","$1":["174718285-12-08T09:27:50.072Z","101952576-03-25T14:24:52.733Z","157596987-05-21T19:10:52.026Z","259261233-06-27T00:09:34.743Z","281902563-03-30T01:21:37.063Z","149749814-02-09T19:15:22.386Z","43817390-04-23T14:28:07.727Z","207200041-08-04T08:33:56.368Z","89135625-09-11T04:02:08.339Z","145492615-03-31T17:47:03.596Z"]}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","$1":["201496151-10-17T17:59:36.424Z","54997685-08-11T12:37:27.987Z","221283572-04-26T17:21:14.045Z","225493824-08-31T20:07:46.516Z","182182211-08-27T09:46:05.321Z","274687739-12-20T11:17:55.976Z","122133040-05-30T14:01:38.471Z","47974346-11-10T07:12:06.916Z","16910957-09-01T00:43:17.800Z","139590224-10-13T19:02:17.084Z"]}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":["22231408-02-26T18:49:05.132Z","89749862-06-30T12:45:53.714Z","39976651-03-08T06:16:28.056Z","50962470-04-09T19:39:48.674Z","267833695-02-20T16:43:53.029Z","285857472-05-30T05:23:59.844Z","254833053-12-29T10:32:42.305Z","207557890-12-19T08:36:43.666Z","284881605-12-22T15:05:24.441Z","288246588-09-19T14:39:52.507Z"]}
!end
test select timestamp - timestampField > 483843079 from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":true}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","$1":true}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":false}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":false}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","$1":false}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","$1":true}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","$1":true}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","$1":true}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","$1":false}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":true}
!end
test select intField, timestamp - timestampField as int64, timestamp - timestampField <= intField from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","intField":1187042131,"$1":1075602186,"$2":true}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","intField":-826078049,"$1":1052692663,"$2":false}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","intField":583793597,"$1":468741553,"$2":true}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","intField":-387378143,"$1":483843079,"$2":false}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","intField":864852950,"$1":131064496,"$2":true}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","intField":-1724667072,"$1":812967685,"$2":false}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","intField":-1560478339,"$1":1416247777,"$2":false}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","intField":-1288276511,"$1":1346898466,"$2":false}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","intField":184824140,"$1":211680842,"$2":false}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","intField":713513287,"$1":1214828872,"$2":false}
!end
test select timestampList > longField from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":[true,true,true,true,true,true,true,true,true,true]}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","$1":[true,true,true,true,true,true,true,true,true,true]}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":[true,true,true,true,true,true,true,true,true,true]}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":[false,false,false,false,false,false,false,false,false,false]}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","$1":[false,false,false,false,false,false,false,false,false,false]}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","$1":[false,false,false,false,false,false,false,false,false,false]}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","$1":[false,false,false,false,false,false,false,false,false,false]}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","$1":[true,true,true,true,true,true,true,true,true,true]}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","$1":[false,false,false,false,false,false,false,false,false,false]}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":[false,false,false,false,false,false,false,false,false,false]}
!end
test select timestampField > longField from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":true}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","$1":true}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":true}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":false}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","$1":false}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","$1":false}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","$1":false}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","$1":true}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","$1":false}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":false}
!end
test select timestampList > 1617355093653 from "1min-1h-1h-3"
0: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:13:16.646Z","$1":[true,true,true,true,false,true,true,true,true,false]}
1: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:14:16.646Z","$1":[true,true,false,true,true,true,true,false,false,false]}
2: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:15:16.646Z","$1":[true,true,true,false,false,true,true,false,true,true]}
3: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:16:16.646Z","$1":[true,true,true,true,false,false,true,false,true,true]}
4: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:17:16.646Z","$1":[true,true,false,true,true,true,true,false,true,true]}
5: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:18:16.646Z","$1":[true,true,true,true,true,true,true,true,true,true]}
6: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:19:16.646Z","$1":[true,true,true,true,true,true,true,false,true,true]}
7: {"$type":"","symbol":"S2","timestamp":"2021-04-19T01:20:16.646Z","$1":[true,true,false,true,true,true,true,true,true,true]}
8: {"$type":"","symbol":"S3","timestamp":"2021-04-19T01:21:16.646Z","$1":[true,true,true,true,true,false,true,true,true,true]}
9: {"$type":"","symbol":"S1","timestamp":"2021-04-19T01:22:16.646Z","$1":[true,false,true,true,true,true,true,true,false,true]}
!end
